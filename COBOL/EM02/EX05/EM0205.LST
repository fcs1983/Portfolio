* Microsoft COBOL Version 5.0        L2.4 revision 003 13-Oct-15 23:35 Page   1
*                                        EM0205.CBL
* Options: LIST(EM0205.LST) ASMLIST(EM0205.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EM0205.
     3 AUTHOR.        FABIO COSTA.
     4 INSTALLATION.  FATEC-SP.
     5 DATE-WRITTEN.  13/10/2015.
     6 DATE-COMPILED. 13-Oct-15 2.
     7 SECURITY.      NAO MODIFICAR SEM AUTORIZACAO.
     8*REMARKS.       LER ARQALU, CALCULAR A MEDIA DAS NOTAS,
     9*               SE ALUNO APROVADO IMPRIMIR RELATORIO, SE
    10*               REPROVADO GRAVAR EM ARQREP.
    11
    12 ENVIRONMENT DIVISION.
    13 CONFIGURATION SECTION.
    14 SOURCE-COMPUTER.  IBM-PC.
    15 OBJECT-COMPUTER.  IBM-PC.
    16 SPECIAL-NAMES.    DECIMAL-POINT IS COMMA.
    17
    18 INPUT-OUTPUT SECTION.
    19 FILE-CONTROL.
    20     SELECT ARQALU ASSIGN TO DISK
    21     ORGANIZATION IS LINE SEQUENTIAL.
    22
    23     SELECT ARQREP ASSIGN TO DISK
    24     ORGANIZATION IS LINE SEQUENTIAL.
    25
    26     SELECT RELAPROV ASSIGN TO DISK.
    27
    28 DATA DIVISION.
    29 FILE SECTION.
    30
    31 FD ARQALU
    32     LABEL RECORD ARE STANDARD
    33     VALUE OF FILE-ID IS "ARQALU.DAT".
    34
    35 01 REG-ENT.
    36     02 MAT-ENT        PIC 9(07).
    37     02 NOME-ENT       PIC X(30).
    38     02 NOTA1-ENT      PIC 99V99.
    39     02 NOTA2-ENT      PIC 99V99.
    40     02 NOTA3-ENT      PIC 99V99.
    41     02 FALTAS-ENT     PIC 99.
    42     02 SEXO-ENT       PIC X.
    43
    44 FD ARQREP
    45     LABEL RECORD ARE STANDARD
    46     VALUE OF FILE-ID IS "ARQREP.DAT".
    47
    48 01 REG-SAI.
    49     02 MAT-SAI        PIC 9(07).
    50     02 NOME-SAI       PIC X(30).
    51     02 NOTA1-SAI      PIC 99V99.
    52     02 NOTA2-SAI      PIC 99V99.
    53     02 NOTA3-SAI      PIC 99V99.
    54     02 FALTAS-SAI     PIC 99.
    55     02 SEXO-SAI       PIC X.
    56
    57 FD RELAPROV
* Microsoft COBOL Version 5.0        L2.4 revision 003 13-Oct-15 23:35 Page   2
*                                        EM0205.CBL
    58     LABEL RECORD IS OMMITED.
    59
    60 01 REL-SAI            PIC X(80).
    61
    62 WORKING-STORAGE SECTION.
    63
    64 77 FIM-ARQ            PIC X(03)  VALUE "NAO".
    65 77 CT-LIN             PIC 99     VALUE 30.
    66 77 CT-PAG             PIC 99     VALUE ZEROES.
    67 77 SOMA-NOTAS         PIC 99V99  VALUE ZEROES.
    68 77 MEDIA-NOTAS        PIC 99V99  VALUE ZEROES.
    69 77 SOMA-GERAL         PIC 999V99 VALUE ZEROES.
    70 77 MEDIA-GERAL        PIC 99V99  VALUE ZEROES.
    71 77 TOT-APR            PIC 9(03)  VALUE ZEROES.
    72
    73 01 CAB-01.
    74     02 FILLER         PIC X(26) VALUE SPACES.
    75     02 FILLER         PIC X(27) VALUE
    76                       "RELACAO DE ALUNOS APROVADOS".
    77     02 FILLER         PIC X(16) VALUE SPACES.
    78     02 FILLER         PIC X(05) VALUE "PAG.".
    79     02 VAR-PAG        PIC ZZ9   VALUE ZEROES.
    80     02 FILLER         PIC X(03) VALUE SPACES.
    81
    82 01 CAB-02.
    83     02 FILLER         PIC X(04) VALUE SPACES.
    84     02 FILLER         PIC X(06) VALUE "NUMERO".
    85     02 FILLER         PIC X(14) VALUE SPACES.
    86     02 FILLER         PIC X(13) VALUE "NOME DO ALUNO".
    87     02 FILLER         PIC X(15) VALUE SPACES.
    88     02 FILLER         PIC X(05) VALUE "MEDIA".
    89     02 FILLER         PIC X(10) VALUE SPACES.
    90     02 FILLER         PIC X(06) VALUE "FALTAS".
    91     02 FILLER         PIC X(07) VALUE SPACES.
    92
    93 01 CAB-03.
    94     02 FILLER         PIC X(80) VALUE SPACES.
    95
    96 01 DETALHE.
    97     02 FILLER         PIC X(04) VALUE SPACES.
    98     02 NUMERO         PIC 999999.9.
    99     02 FILLER         PIC X(05) VALUE SPACES.
   100     02 NOME           PIC X(30).
   101     02 FILLER         PIC X(05) VALUE SPACES.
   102     02 MEDIA          PIC Z9,99.
   103     02 FILLER         PIC X(12) VALUE SPACES.
   104     02 FALTAS         PIC 99.
   105     02 FILLER         PIC X(11) VALUE SPACES.
   106
   107 01 TOT-SAI.
   108     02 FILLER         PIC X(04) VALUE SPACES.
   109     02 FILLER         PIC X(27) VALUE
   110                       "TOTAL DE ALUNOS APROVADOS: ".
   111     02 TOTAPR         PIC 9(05).
   112
   113 01 MED-TURMA.
   114     02 FILLER         PIC X(04) VALUE SPACES.
   115     02 FILLER         PIC X(22) VALUE "MEDIA GERAL DA TURMA: ".
* Microsoft COBOL Version 5.0        L2.4 revision 003 13-Oct-15 23:35 Page   3
*                                        EM0205.CBL
   116     02 MED-TURMA1     PIC Z9,99.
   117
   118 PROCEDURE DIVISION.
   119
   120 EM02-05.
   121     PERFORM INICIO.
   122     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
   123     PERFORM TOTAL.
   124     PERFORM FIM.
   125     STOP RUN.
   126
   127 INICIO.
   128     OPEN INPUT  ARQALU
   129          OUTPUT ARQREP
   130          OUTPUT RELAPROV.
   131     PERFORM LEITURA.
   132
   133 LEITURA.
   134     READ ARQALU AT END MOVE "SIM" TO FIM-ARQ.
   135
   136 PRINCIPAL.
   137     PERFORM CALCMEDIA.
   138     IF MEDIA-NOTAS IS LESS THAN 7,0 OR
   139              FALTAS-ENT IS GREATER THAN 15 THEN
   140         PERFORM REPROVADO
   141     ELSE
   142         PERFORM APROVADO.
   143     PERFORM LEITURA.
   144
   145 CALCMEDIA.
   146     ADD NOTA1-ENT NOTA2-ENT NOTA3-ENT GIVING SOMA-NOTAS.
   147     DIVIDE SOMA-NOTAS BY 3,0 GIVING MEDIA-NOTAS.
   148
   149 REPROVADO.
   150     MOVE MAT-ENT TO MAT-SAI.
   151     MOVE NOME-ENT TO NOME-SAI.
   152     MOVE NOTA1-ENT TO NOTA1-SAI.
   153     MOVE NOTA2-ENT TO NOTA2-SAI.
   154     MOVE NOTA3-ENT TO NOTA3-SAI.
   155     MOVE FALTAS-ENT TO FALTAS-SAI.
   156     MOVE SEXO-ENT TO SEXO-SAI.
   157     WRITE REG-SAI.
   158
   159 APROVADO.
   160     IF CT-LIN IS GREATER THAN 29
   161         PERFORM CABECALHO.
   162     PERFORM IMPDET.
   163     ADD 1 TO TOT-APR.
   164     ADD MEDIA-NOTAS TO SOMA-GERAL.
   165
   166 CABECALHO.
   167     ADD 1 TO CT-PAG.
   168     MOVE CT-PAG TO VAR-PAG.
   169     MOVE SPACES TO REL-SAI.
   170     WRITE REL-SAI AFTER ADVANCING PAGE.
   171     WRITE REL-SAI FROM CAB-01 AFTER ADVANCING 1 LINE.
   172     WRITE REL-SAI FROM CAB-02 AFTER ADVANCING 2 LINES.
   173     WRITE REL-SAI FROM CAB-03 AFTER ADVANCING 1 LINES
* Microsoft COBOL Version 5.0        L2.4 revision 003 13-Oct-15 23:35 Page   4
*                                        EM0205.CBL
   174     MOVE ZEROES TO CT-LIN.
   175
   176 IMPDET.
   177     MOVE MAT-ENT TO NUMERO.
   178     MOVE NOME-ENT TO NOME.
   179     MOVE MEDIA-NOTAS TO MEDIA.
   180     MOVE FALTAS-ENT TO FALTAS.
   181     WRITE REL-SAI FROM DETALHE AFTER ADVANCING 1 LINE.
   182     ADD 1 TO CT-LIN.
   183
   184 TOTAL.
   185     MOVE TOT-APR TO TOTAPR.
   186     DIVIDE SOMA-GERAL BY TOT-APR GIVING MEDIA-GERAL.
   187     MOVE MEDIA-GERAL TO MED-TURMA1.
   188     WRITE REL-SAI FROM TOT-SAI AFTER ADVANCING 3 LINES.
   189     WRITE REL-SAI FROM MED-TURMA AFTER ADVANCING 1 LINE.
   190
   191 FIM.
   192     CLOSE ARQALU
   193           ARQREP
   194           RELAPROV.
   195
   196
   197
   198
   199
   200
   201
   202
   203
   204
   205
   206
   207
   208
   209
   210
* Microsoft COBOL Version 5.0        L2.4 revision 003
* (C)Copyright Microsoft Corp 1984, 1993       URN AXUPA/ZZ0/00001
*                                              REF GNB-029052003A8
*
* Total Messages:     0
* Data:        1636     Code:         897
