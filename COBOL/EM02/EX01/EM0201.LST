* Microsoft COBOL Version 5.0        L2.4 revision 003 12-Oct-15 17:33 Page   1
*                                        EM0201.CBL
* Options: LIST(EM0201.LST) ASMLIST(EM0201.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EM0201.
     3 AUTHOR.        FABIO COSTA.
     4 INSTALLATION.  FATEC-SP.
     5 DATE-WRITTEN.  17/09/2015.
     6 DATE-COMPILED. 12-Oct-15 1.
     7 SECURITY.      NAO MODIFICAR SEM AUTORIZACAO.
     8*REMARKS.       LER CADSOC1, SE EM DIA GRAVAR EM CADSOC2, SE
     9*               EM ATRAZO, IMPRIMIR RELATORIO VIDE LAYOUT.
    10
    11 ENVIRONMENT DIVISION.
    12 CONFIGURATION SECTION.
    13 SOURCE-COMPUTER.  IBM-PC.
    14 OBJECT-COMPUTER.  IBM-PC.
    15 SPECIAL-NAMES.    DECIMAL-POINT IS COMMA.
    16
    17 INPUT-OUTPUT SECTION.
    18 FILE-CONTROL.
    19     SELECT CADSOC1 ASSIGN TO DISK
    20     ORGANIZATION IS LINE SEQUENTIAL.
    21
    22     SELECT CADSOC2 ASSIGN TO DISK
    23     ORGANIZATION IS LINE SEQUENTIAL.
    24
    25     SELECT RELSOCIO ASSIGN TO DISK.
    26
    27 DATA DIVISION.
    28 FILE SECTION.
    29
    30 FD CADSOC1
    31     LABEL RECORD ARE STANDARD
    32     VALUE OF FILE-ID IS "CADSOC1.DAT".
    33
    34 01 REG-ENT.
    35     02 COD-PAG1       PIC 9(02).
    36     02 NUM-SOC1       PIC 9(06).
    37     02 NOME-SOC1      PIC X(30).
    38     02 VAL-PAG1       PIC 9(09)V9(02).
    39
    40 FD CADSOC2
    41     LABEL RECORD ARE STANDARD
    42     VALUE OF FILE-ID IS "CADSOC2.DAT".
    43
    44 01 REG-SAI.
    45     02 NUM-SOC2       PIC 9(06).
    46     02 NOME-SOC2      PIC X(30).
    47     02 VAL-PAG2       PIC 9(09)V9(02).
    48
    49 FD RELSOCIO
    50     LABEL RECORD IS OMITTED.
    51
    52 01 REG-ATR            PIC X(80).
    53
    54 WORKING-STORAGE SECTION.
    55
    56 77 FIM-ARQ            PIC X(03) VALUE "NAO".
    57 77 CT-LIN             PIC 9(02) VALUE 30.
* Microsoft COBOL Version 5.0        L2.4 revision 003 12-Oct-15 17:33 Page   2
*                                        EM0201.CBL
    58 77 CT-PAG             PIC 9(02) VALUE ZEROES.
    59 77 TOT-SOC            PIC 9(05) VALUE ZEROES.
    60 77 VAL-TOT            PIC 9(09)V9(02) VALUE ZEROES.
    61
    62 01 CAB-01.
    63     02 FILLER         PIC X(70) VALUE SPACES.
    64     02 FILLER         PIC X(05) VALUE "PAG. ".
    65     02 VAR-PAG        PIC Z9.
    66     02 FILLER         PIC X(03) VALUE SPACES.
    67
    68 01 CAB-02.
    69     02 FILLER         PIC X(26) VALUE SPACES.
    70     02 FILLER         PIC X(28) VALUE
    71                       "RELACAO DE SOCIOS ATRAZADOS ".
    72     02 FILLER         PIC X(26) VALUE SPACES.
    73
    74 01 CAB-03.
    75     02 FILLER         PIC X(05) VALUE SPACES.
    76     02 FILLER         PIC X(15) VALUE "NUMERO DO SOCIO".
    77     02 FILLER         PIC X(10) VALUE SPACES.
    78     02 FILLER         PIC X(13) VALUE "NOME DO SOCIO".
    79     02 FILLER         PIC X(15) VALUE SPACES.
    80     02 FILLER         PIC X(18) VALUE "VALOR DO PAGAMENTO".
    81     02 FILLER         PIC X(05) VALUE SPACES.
    82
    83 01 CAB-04.
    84     02 FILLER         PIC X(80) VALUE SPACES.
    85
    86 01 DETALHE.
    87     02 FILLER         PIC X(09) VALUE SPACES.
    88     02 NUMERO         PIC 999.999.
    89     02 FILLER         PIC X(15).
    90     02 NOME           PIC X(30).
    91     02 VALOR          PIC ZZZ.ZZZ.ZZ9,99.
    92
    93 01 SOCTOT.
    94     02 FILLER         PIC X(05) VALUE SPACES.
    95     02 FILLER         PIC X(27) VALUE
    96                           "TOTAL DE SOCIOS ATRAZADOS: ".
    97     02 TOT1           PIC zz99 VALUE ZEROES.
    98     02 FILLER         PIC X(43) VALUE SPACES.
    99
   100 01 VALTOT.
   101     02 FILLER         PIC X(05) VALUE SPACES.
   102     02 FILLER         PIC X(22) VALUE "VALOR TOTAL ATRAZADO: ".
   103     02 TOT2           PIC ZZZ.ZZZ.ZZZ.ZZ9,99.
   104     02 FILLER         PIC X(42) VALUE SPACES.
   105
   106 PROCEDURE DIVISION.
   107
   108 EM02-EX01.
   109     PERFORM INICIO.
   110     PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL "SIM".
   111     PERFORM TOTAL.
   112     PERFORM FIM.
   113     STOP RUN.
   114
   115 INICIO.
* Microsoft COBOL Version 5.0        L2.4 revision 003 12-Oct-15 17:33 Page   3
*                                        EM0201.CBL
   116     OPEN INPUT  CADSOC1
   117          OUTPUT CADSOC2
   118          OUTPUT RELSOCIO.
   119     PERFORM LEITURA.
   120
   121 LEITURA.
   122     READ CADSOC1 AT END MOVE "SIM" TO FIM-ARQ.
   123
   124 PRINCIPAL.
   125     IF COD-PAG1 IS EQUAL TO 1 THEN
   126         PERFORM GRAVACAO
   127     ELSE
   128         PERFORM IMPRESSAO.
   129     PERFORM LEITURA.
   130
   131 GRAVACAO.
   132     MOVE NUM-SOC1 TO NUM-SOC2.
   133     MOVE NOME-SOC1 TO NOME-SOC2.
   134     MOVE VAL-PAG1 TO VAL-PAG2.
   135     WRITE REG-SAI.
   136
   137 IMPRESSAO.
   138     IF CT-LIN IS GREATER THAN 29
   139         PERFORM CABECALHO.
   140     PERFORM IMPDET.
   141
   142 CABECALHO.
   143     ADD 1 TO CT-PAG.
   144     MOVE CT-PAG TO VAR-PAG.
   145     MOVE SPACES TO REG-ATR.
   146     WRITE REG-ATR AFTER ADVANCING PAGE.
   147     WRITE REG-ATR FROM CAB-01 AFTER ADVANCING 1 LINE.
   148     WRITE REG-ATR FROM CAB-02 AFTER ADVANCING 3 LINES.
   149     WRITE REG-ATR FROM CAB-03 AFTER ADVANCING 3 LINES.
   150     WRITE REG-ATR FROM CAB-04 AFTER ADVANCING 1 LINE.
   151     MOVE ZEROES TO CT-LIN.
   152
   153 IMPDET.
   154     MOVE NUM-SOC1 TO NUMERO.
   155     MOVE NOME-SOC1 TO NOME.
   156     MOVE VAL-PAG1 TO VALOR.
   157     ADD 1 TO TOT-SOC.
   158     ADD VAL-PAG1 TO VAL-TOT.
   159     WRITE REG-ATR FROM DETALHE AFTER ADVANCING 1 LINE.
   160     ADD 1 TO CT-LIN.
   161
   162 TOTAL.
   163     MOVE TOT-SOC TO TOT1.
   164     MOVE VAL-TOT TO TOT2
   165     MOVE SPACES TO REG-ATR.
   166     WRITE REG-ATR FROM SOCTOT AFTER ADVANCING 3 LINES.
   167     WRITE REG-ATR FROM VALTOT AFTER ADVANCING 1 LINE.
   168
   169 FIM.
   170     CLOSE CADSOC1
   171           CADSOC2
   172           RELSOCIO.
   173
* Microsoft COBOL Version 5.0        L2.4 revision 003 12-Oct-15 17:33 Page   4
*                                        EM0201.CBL
   174
   175
   176
   177
   178
   179
   180
   181
   182
   183
   184
   185
* Microsoft COBOL Version 5.0        L2.4 revision 003
* (C)Copyright Microsoft Corp 1984, 1993       URN AXUPA/ZZ0/00001
*                                              REF GNB-029052003A8
*
* Total Messages:     0
* Data:        1796     Code:         861
